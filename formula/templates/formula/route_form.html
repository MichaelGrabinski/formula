{% extends 'admin/base.html' %}
{% load i18n unfold %}

{% block content %}
<div class="flex flex-col gap-4">
    <div class="flex flex-row items-center">
        <h2 class="text-xl font-semibold flex-1">{% trans "Create or Update Route" %}</h2>
    </div>

    {% component "unfold/components/card.html" %}
        <form method="post" class="flex flex-col gap-4">{% csrf_token %}
            {{ form.as_p }}
            <div class="flex justify-end gap-2">
                {% component "unfold/components/button.html" with submit=1 variant="primary" %}{% trans "Save" %}{% endcomponent %}
            </div>
        </form>
    {% endcomponent %}

        {% if object and object.start_latitude and object.end_latitude %}
        {% component "unfold/components/card.html" %}
            <div class="p-4">
                <div class="text-sm mb-2">{% trans "Map preview" %}</div>
                <iframe
                    class="w-full h-80 rounded border"
                    loading="lazy"
                    referrerpolicy="no-referrer-when-downgrade"
                    src="https://www.google.com/maps/embed/v1/directions?key={{ GOOGLE_MAPS_EMBED_API_KEY|default:'' }}&origin={{ object.start_latitude }},{{ object.start_longitude }}&destination={{ object.end_latitude }},{{ object.end_longitude }}">
                </iframe>
                <div class="text-xs text-muted-foreground mt-2">{% trans "Configure GOOGLE_MAPS_EMBED_API_KEY to enable the map." %}</div>
            </div>
        {% endcomponent %}
        {% endif %}
</div>
{% endblock %}
